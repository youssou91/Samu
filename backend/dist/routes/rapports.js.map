{"version":3,"file":"rapports.js","names":["express","require","router","Router","check","auth","authorize","obtenirPerformanceMedecins","obtenirSatisfactionPatients","genererRapportPersonnalise","exporterRapport","buildRapportMedecins","adminOnly","get","optional","isISO8601","isMongoId","post","isIn","isObject","isArray","module","exports"],"sources":["../../src/routes/rapports.js"],"sourcesContent":["const express = require('express');\nconst router = express.Router();\nconst { check } = require('express-validator');\nconst { auth, authorize } = require('../middleware/auth');\nconst { \n  obtenirPerformanceMedecins, \n  obtenirSatisfactionPatients \n} = require('../controllers/rapportsController2');\nconst { \n  genererRapportPersonnalise, \n  exporterRapport \n} = require('../controllers/rapportsController3');\n\n// Importer les contrôleurs de la partie 4\nconst { \n  buildRapportMedecins \n} = require('../controllers/rapportsController4');\n\n// Middleware pour vérifier les rôles autorisés\nconst adminOnly = authorize('admin');\n\n/**\n * @route   GET /api/rapports/performance-medecins\n * @desc    Obtenir les statistiques de performance des médecins\n * @access  Admin\n */\nrouter.get(\n  '/performance-medecins',\n  [\n    auth,\n    adminOnly,\n    check('dateDebut', 'Format de date de début invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601(),\n    check('dateFin', 'Format de date de fin invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601()\n  ],\n  obtenirPerformanceMedecins\n);\n\n/**\n * @route   GET /api/rapports/satisfaction\n * @desc    Obtenir les statistiques de satisfaction des patients\n * @access  Admin\n */\nrouter.get(\n  '/satisfaction',\n  [\n    auth,\n    adminOnly,\n    check('dateDebut', 'Format de date de début invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601(),\n    check('dateFin', 'Format de date de fin invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601(),\n    check('medecinId', 'ID de médecin invalide')\n      .optional()\n      .isMongoId()\n  ],\n  obtenirSatisfactionPatients\n);\n\n/**\n * @route   POST /api/rapports/personnalise\n * @desc    Générer un rapport personnalisé\n * @access  Admin\n */\nrouter.post(\n  '/personnalise',\n  [\n    auth,\n    adminOnly,\n    check('typeRapport', 'Le type de rapport est requis')\n      .isIn(['rendez-vous', 'patients', 'medecins', 'financier', 'satisfaction', 'performance']),\n    check('dateDebut', 'Format de date de début invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601(),\n    check('dateFin', 'Format de date de fin invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601(),\n    check('groupBy', 'Le type de regroupement est invalide')\n      .optional()\n      .isIn(['day', 'week', 'month', 'year', 'medecin', 'patient', 'type']),\n    check('filtres', 'Les filtres doivent être un objet')\n      .optional()\n      .isObject(),\n    check('colonnes', 'Les colonnes doivent être un tableau')\n      .optional()\n      .isArray()\n  ],\n  genererRapportPersonnalise\n);\n\n/**\n * @route   POST /api/rapports/export\n * @desc    Exporter un rapport au format CSV ou Excel\n * @access  Admin\n */\nrouter.post(\n  '/export',\n  [\n    auth,\n    adminOnly,\n    check('format', 'Le format d\\'export est invalide')\n      .optional()\n      .isIn(['csv', 'excel', 'json']),\n    check('typeRapport', 'Le type de rapport est requis pour l\\'export')\n      .isIn(['rendez-vous', 'patients', 'medecins', 'financier', 'satisfaction', 'performance']),\n    check('dateDebut', 'Format de date de début invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601(),\n    check('dateFin', 'Format de date de fin invalide (YYYY-MM-DD)')\n      .optional()\n      .isISO8601()\n  ],\n  exporterRapport\n);\n\nmodule.exports = router;\n"],"mappings":"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","ignoreList":[]}